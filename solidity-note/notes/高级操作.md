ERC标准

* ERC和EIP的区别

* 标准合约介绍

智能合约的升级

* 升级实践

智能合约互操作性

* 互操作方法



### ERC标准

#### ERC和EIP的区别

ERC（Ethereum Request for Comments）是以太坊生态系统中用于制定代币和智能合约接口规范的标准。例如，ERC-20定义了代币标准接口，使不同的代币在以太坊网络上能够一起工作。ERC-721定义了不可替代代币（NFT）的标准接口，使得它们在不同的平台上可互操作。

EIP（Ethereum Improvement Proposal）则是用于提出以太坊网络协议和功能改进的标准。EIP包括协议升级、新功能的引入等。例如，EIP-1559引入了以太坊网络的燃料费改进，改善了交易费用的可预测性和效率。

它们的联系在于，ERC 标准通常是作为 EIP 的一部分提出的，以推动以太坊网络的功能和互操作性的发展。ERC 标准关注智能合约和代币层面，而 EIP 标准关注底层协议和网络功能的改进。它们共同推动了以太坊生态系统的创新和发展。



#### 标准合约介绍

##### ERC-20 

ERC-20 是用于定义代币的标准接口，使得不同代币能够在以太坊网络上相互兼容。它是以太坊上最常见的代币标准之一。

```solidity
// ERC-20 接口定义
interface IERC20 {
    // 查询代币的总供应量
    function totalSupply() external view returns (uint256);

    // 查询指定账户的代币余额
    function balanceOf(address account) external view returns (uint256);

    // 将代币转移到指定账户
    function transfer(address to, uint256 amount) external returns (bool);

    // 查询一个账户允许另一个账户转移的代币数量
    function allowance(address owner, address spender) external view returns (uint256);

    // 授权一个账户可以转移一定数量的代币
    function approve(address spender, uint256 amount) external returns (bool);

    // 由授权的账户转移代币
    function transferFrom(address from, address to, uint256 amount) external returns (bool);

    // 代币转移事件
    event Transfer(address indexed from, address indexed to, uint256 value);

    // 授权事件
    event Approval(address indexed owner, address indexed spender, uint256 value);
}
```

##### ERC-721 

ERC-721 是用于定义不可替代代币（NFT）的标准接口，每个 NFT 都有唯一的标识符

```solidity
// ERC-721 接口定义
interface IERC721 {
    // 查询指定账户拥有的 NFT 数量
    function balanceOf(address owner) external view returns (uint256);

    // 查询指定 NFT 的所有者
    function ownerOf(uint256 tokenId) external view returns (address);

    // 安全地将 NFT 转移到指定账户
    function safeTransferFrom(address from, address to, uint256 tokenId) external;

    // 将 NFT 转移到指定账户
    function transferFrom(address from, address to, uint256 tokenId) external;

    // 授权一个账户可以管理指定 NFT
    function approve(address to, uint256 tokenId) external;

    // 查询被授权管理某个 NFT 的账户
    function getApproved(uint256 tokenId) external view returns (address);

    // 授权一个账户管理所有 NFT
    function setApprovalForAll(address operator, bool approved) external;

    // NFT 转移事件
    event Transfer(address indexed from, address indexed to, uint256 indexed tokenId);

    // NFT 授权事件
    event Approval(address indexed owner, address indexed spender, uint256 indexed tokenId);
}
```

##### ERC-1155 

ERC-1155 是用于定义多功能代币的标准接口，支持一次性创建多个不同类型的代币

```solidity
// ERC-1155 接口定义
interface IERC1155 {
    // 查询指定账户拥有的特定类型代币的数量
    function balanceOf(address account, uint256 id) external view returns (uint256);

    // 批量查询多个账户拥有的代币数量
    function balanceOfBatch(address[] calldata accounts, uint256[] calldata ids) external view returns (uint256[] memory);

    // 授权一个账户管理所有代币
    function setApprovalForAll(address operator, bool approved) external;

    // 安全地将代币转移到指定账户
    function safeTransferFrom(address from, address to, uint256 id, uint256 amount, bytes calldata data) external;

    // 批量安全地将代币转移到指定账户
    function safeBatchTransferFrom(address from, address to, uint256[] calldata ids, uint256[] calldata amounts, bytes calldata data) external;

    // 单个代币转移事件
    event TransferSingle(address indexed operator, address indexed from, address indexed to, uint256 id, uint256 value);

    // 批量代币转移事件
    event TransferBatch(address indexed operator, address indexed from, address indexed to, uint256[] ids, uint256[] values);

    // 代币授权事件
    event ApprovalForAll(address indexed owner, address indexed operator, bool approved);
}
```
